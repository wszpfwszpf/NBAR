# 事件流降噪用于光流评估

本仓库用于探索 **事件流降噪是否能够稳定提升下游光流质量**，  
而非追求事件结构的严格保持或构建通用型降噪器。

当前项目处于 **结构重构与流程稳定阶段**。

---

## 项目目标

本项目的核心目标是：

> 在允许一定误删真实事件的前提下，  
> 验证轻量级事件流降噪策略是否能够 **整体提升光流估计效果**。

本项目 **不是**：
- 结构保持型事件降噪算法  
- 通用事件增强或重建方法  

---

## 整体流程

当前的概念性流程如下：

原始事件流

↓

S1（可选，偏激进的过滤）

↓

S2（可选，补偿 / 细化）

↓

光流评估

- **S1**：  
  允许误删真实事件，只要整体光流质量稳定提升即可。
- **S2**：  
  用于对 S1 的结果进行补偿或细化，不要求严格保持原始结构。

---

## 设计原则与约束

- 事件表示形式固定为 **(t, x, y, p)**。
- 优先考虑 **实时性与工程可部署性**。
- 当前阶段 **刻意避免**：
  - FFT 等频域分析方法  
  - 复杂或大规模深度模型  
  - 离线或全局优化模块  
- 更关注 **工程可控性与实验可验证性**，而非算法复杂度。

---

## 当前状态说明

- 代码正处于 **结构性重构阶段**。
- 当前重构目标：
  - 理清代码结构
  - 明确模块接口
  - 支持 S1 / S2 的可插拔设计
- 本阶段 **不引入新的降噪算法或策略**。

---

## 使用说明（临时）

当前接口仍在调整中，具体使用方式将在结构稳定后补充。

---

## 备注

- 所有中间可视化结果、图片、视频及生成数据均不纳入版本管理。
- 本仓库优先保证 **实验逻辑清晰与可复现性**，而非功能完整性。


## 最小可运行示例（用于回归验证）

说明：本节用于保证代码在重构前后能够跑通基本流程，不用于展示最终性能或完整实验结果。

- 1）数据准备（示例）

在仓库根目录下的 data/ 目录放入一段事件数据，例如：
data/example_events.npz

事件数据需至少包含以下字段（命名以实际文件为准）：
t：时间戳
x：像素横坐标
y：像素纵坐标
p：极性

- 2）运行 S1 基础处理（最小验证）
命令：
python S1.py data/example_events.npz

预期结果：

程序正常结束，无报错

控制台输出事件数量/保留率等统计信息（如果代码里有）

如脚本会生成输出文件（图片/npz/log），则输出路径与重构前保持一致

- 3）运行阶段对比脚本（可选）
命令：
python conpare_stage1.py data/example_events.npz

用途：

对比 raw 与 S1 处理后的事件差异

用于 sanity check，而非定量评测

- 4）可视化验证（可选）
命令：
python visual.py data/example_events.npz

用途：

人工直观检查事件分布与可视化输出是否合理

用于确认重构未破坏数据读写与绘制流程

- 5）回归验证原则（重要） 
在进行任何结构性重构后，至少需满足：

上述命令仍可正常运行

程序行为与输出形式不发生“突变”

事件数量变化趋势与重构前一致（允许微小差异，但不允许数量级变化）

若最小示例无法运行，则视为重构失败，应立即回滚。