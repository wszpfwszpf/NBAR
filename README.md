# 事件流降噪用于光流评估

本仓库用于探索 **事件流降噪是否能够稳定提升下游光流质量**，  
而非追求事件结构的严格保持或构建通用型降噪器。

当前项目处于 **结构重构与流程稳定阶段**。

---

## 项目目标

本项目的核心目标是：

> 在允许一定误删真实事件的前提下，  
> 验证轻量级事件流降噪策略是否能够 **整体提升光流估计效果**。

本项目 **不是**：
- 结构保持型事件降噪算法  
- 通用事件增强或重建方法  

---

## 整体流程

当前的概念性流程如下：

原始事件流

↓

S1（可选，偏激进的过滤）

↓

S2（可选，补偿 / 细化）

↓

光流评估

- **S1**：  
  允许误删真实事件，只要整体光流质量稳定提升即可。
- **S2**：  
  用于对 S1 的结果进行补偿或细化，不要求严格保持原始结构。

---

## 设计原则与约束

- 事件表示形式固定为 **(t, x, y, p)**。
- 优先考虑 **实时性与工程可部署性**。
- 当前阶段 **刻意避免**：
  - FFT 等频域分析方法  
  - 复杂或大规模深度模型  
  - 离线或全局优化模块  
- 更关注 **工程可控性与实验可验证性**，而非算法复杂度。

---

## 当前状态说明

- 代码正处于 **结构性重构阶段**。
- 当前重构目标：
  - 理清代码结构
  - 明确模块接口
  - 支持 S1 / S2 的可插拔设计
- 本阶段 **不引入新的降噪算法或策略**。

---

## 使用说明

### PyCharm 一键运行（推荐）

- 打开根目录下的 `test.py`。
- 根据本地数据路径修改文件顶部的 `INPUT_NPZ`（如有需要可调整 `OUTDIR`）。
- 直接使用 PyCharm 的 Run/Debug 运行脚本。
- 脚本会依次执行回归 1（原始事件流直通并进行哈希校验）和回归 2（S1 stage，包含 `w1` 哈希），输出位于 `outputs_regression/` 下的 `raw/` 与 `s1/` 子目录。

### 命令行（可选）

如果需要命令行方式，可调用 `scripts/run_pipeline.py`：

```bash
python scripts/run_pipeline.py --input <your_input>.npz --outdir outputs_regression --stage raw
python scripts/run_pipeline.py --input <your_input>.npz --outdir outputs_regression --stage s1
```

命令行与 PyCharm 入口共用同一套管线逻辑。

---

## 备注

- 所有中间可视化结果、图片、视频及生成数据均不纳入版本管理。
- 本仓库优先保证 **实验逻辑清晰与可复现性**，而非功能完整性。
